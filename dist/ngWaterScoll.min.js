angular.module("waterScroll",[]).directive("waterScroll",["$timeout",function($timeout){return{scope:{scrollDistance:"@",scrollLoad:"&",scrollContainer:"@",loadingInfo:"@",loadDisabled:"="},link:function(scope,ele,attrs,ctrls){var scropllTop,isDisabled,bodyClientHeight,bodyOffsetHeight,scrollLoading,bodyContainer=document.getElementById(scope.scrollContainer)||document.body,scrollDistance=parseInt(scope.scrollDistance||0),loadingInfo=scope.loadingInfo||"Loadding",isLoading=!1,checkHolder=function(){bodyOffsetHeight=bodyContainer.offsetHeight,bodyOffsetHeight<ele[0].offsetHeight&&toLoading()},toLoading=function(){scope.loadDisabled||isDisabled||(isLoading?isLoading&&(scrollLoading=angular.element(document.querySelector("#scrollLoading")),scrollLoading&&scrollLoading.hasClass("ng-hide")&&scrollLoading.removeClass("ng-hide")):(isLoading=!0,$timeout(function(){scope.scrollLoad()})))};ele.append("<h1 id='scrollLoading' class='text-center'>"+loadingInfo+"</h1>"),checkHolder(),ele.on("scroll",function(e){scropllTop=ele[0].scrollTop,bodyClientHeight=ele[0].clientHeight,bodyOffsetHeight=bodyContainer.offsetHeight,scropllTop+scrollDistance>=bodyOffsetHeight-bodyClientHeight&&toLoading()}),scope.$on("scrollLoadingFinfish",function(){isLoading=!1,isDisabled=!1,checkHolder()}),scope.$on("stopLoading",function(){scrollLoading=document.querySelector("#scrollLoading"),angular.element(scrollLoading).addClass("ng-hide"),isDisabled=!0}),scope.$on("startLoading",function(){isLoading=!1,isDisabled=!1,scrollLoading=angular.element(document.querySelector("#scrollLoading")),scrollLoading&&scrollLoading.hasClass("ng-hide")&&scrollLoading.removeClass("ng-hide"),toLoading()})}}}]);